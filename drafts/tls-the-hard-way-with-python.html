<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>TLS the hard way with python</title>
  <meta name="author" content="Andrew Smith">



  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="../favicon.png" rel="icon">
  <link href="../theme/css/main.css" media="screen, projection"
        rel="stylesheet" type="text/css">
  <script src="../theme/js/modernizr-2.0.js"></script>
  <script src="../theme/js/ender.js"></script>
  <script src="../theme/js/octopress.js" type="text/javascript"></script>

  <link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
  <link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
</head>

<body>
  <header role="banner"><hgroup>
  <h1><a href="../">Andy Smith's Blog</a></h1>
</hgroup></header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
</ul>



<ul class="main-navigation">
      <li><a href="../pages/bluepot.html">bluepot</a></li>
      <li><a href="../pages/chump.html">chump</a></li>
      <li><a href="../pages/contact.html">Contact</a></li>
    <li class="active">
    <a href="../category/blog.html">Blog</a>
    </li>
</ul></nav>
  <div id="main">
    <div id="content">
<div>
  <article class="hentry" role="article">
<header>
      <h1 class="entry-title">TLS the hard way with python</h1>
      <p class="meta"><time datetime="2014-08-20T20:00:00+01:00" pubdate>Wed 20 August 2014</time></p>
</header>

  <div class="entry-content"><p>I wanted to write an article about tor the hard way but that uses TLS. And in
the middle of the article I didn't want to just hand off to some SSL library
because that defeats the point.</p>
<p>So, I'm going to kick off with TLS the hard way and follow up with a Tor
article.</p>
<p>Source: http://security.stackexchange.com/questions/20803/how-does-ssl-tls-work</p>
<p>Looking at the Tor Spec we need  to support (among others, but we'll see if we
can get away with this one) (TLS_DHE_RSA_WITH_AES_128_CBC_SHA|http://tools.ietf.org/html/rfc5246)
which we decode as a DHE_RSA Key Exchange, a AES_128_CBC Cipher and a SHA Max
(Andy: what's a Mac?)</p>
<p>So let's pick DHE_RSA. This is apparently an Ephemeral Diffie-Hellman. </p>
<p>The spec says:</p>
<div class="highlight"><pre>RSA public key; the certificate MUST allow the
digitalSignature bit MUST be set if the key
usage extension is present) with the signature
scheme and hash algorithm that will be employed
in the server key exchange message.
</pre></div>


<p>RSA, how does that work?</p>
<p>http://people.csail.mit.edu/rivest/Rsapaper.pdf</p>
<p>Diffe Helman </p>
<p>http://www4.ncsu.edu/~singer/437/proj38.pdf</p>
<p>Signature, what does it look like?</p>
<p>M(essage)
S(ignature)</p>
<p>Right?</p>
<p>And you must .. perform a function on M(essage) to get S(ignature)</p>
<p>So you must do ..</p>
<div class="highlight"><pre>    their_public_key(M) == S ?
</pre></div></div>
    <footer>
<p class="meta">
  <span class="byline author vcard">
    Posted by <span class="fn">Andrew Smith</span>
  </span>
<time datetime="2014-08-20T20:00:00+01:00" pubdate>Wed 20 August 2014</time>  <span class="categories">
    <a class="category" href="../tag/tls.html">tls</a>
    <a class="category" href="../tag/protocol.html">protocol</a>
    <a class="category" href="../tag/python.html">python</a>
    <a class="category" href="../tag/ssl.html">ssl</a>
  </span>
</p><div class="sharing">
</div>    </footer>
  </article>

</div>
<aside class="sidebar">
  <section>
    <h1>Recent Posts</h1>
    <ul id="recent_posts">
      <li class="post">
          <a href="../2015/03/running-manuka-docker-honeypot/">Running manuka docker honeypot</a>
      </li>
      <li class="post">
          <a href="../2014/05/docker-volume-and-docker-volume/">Docker volume and docker VOLUME</a>
      </li>
      <li class="post">
          <a href="../2014/03/quick-and-easy-ssh-mitm/">Quick and Easy SSH MITM</a>
      </li>
      <li class="post">
          <a href="../2013/08/raspberry-pi-wi-fi-honeypot/">Raspberry Pi Wi-Fi Honeypot</a>
      </li>
      <li class="post">
          <a href="../2013/04/the-15-dollar-honeypot/">The $15 (per year) Honeypot</a>
      </li>
    </ul>
  </section>
  <section>
      
    <h1>Categories</h1>
    <ul id="recent_posts">
        <li><a href="../category/blog.html">Blog</a></li>
    </ul>
  </section>
 

  <section>
  <h1>Tags</h1>
    <a href="../tag/.html"></a>,    <a href="../tag/raspberry-pi.html">raspberry-pi</a>,    <a href="../tag/dionaea.html">dionaea</a>,    <a href="../tag/honeypots.html">honeypots</a>,    <a href="../tag/volume.html">volume</a>,    <a href="../tag/gwt.html">gwt</a>,    <a href="../tag/kippo.html">kippo</a>,    <a href="../tag/mitm.html">mitm</a>,    <a href="../tag/ssh.html">ssh</a>,    <a href="../tag/ec2-honeypot.html">ec2 honeypot</a>,    <a href="../tag/docker.html">docker</a>,    <a href="../tag/wi-fi.html">wi-fi</a>,    <a href="../tag/honeypot.html">honeypot</a>,    <a href="../tag/access-point.html">access-point</a>  </section>



  <section>
    <h1>GitHub Repos</h1>
    <ul id="gh_repos">
      <li class="loading">Status updating...</li>
    </ul>
    <script type="text/javascript">
      $.domReady(function(){
          if (!window.jXHR){
              var jxhr = document.createElement('script');
              jxhr.type = 'text/javascript';
              jxhr.src = '../theme/js/jXHR.js';
              var s = document.getElementsByTagName('script')[0];
              s.parentNode.insertBefore(jxhr, s);
          }

          github.showRepos({
              user: 'andrewmichaelsmith',
              count: 5,
              skip_forks: false,
              target: '#gh_repos'
          });
      });
    </script>
    <script src="../theme/js/github.js" type="text/javascript"> </script>
  </section>


<section>
    <p>Follow <a href="http://twitter.com/bingleybeep">@bingleybeep</a></p>
</section>
</aside>    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Andrew Smith -
  <span class="credit">Powered by <a href="http://getpelican.com">Pelican</a></span>
</p></footer>
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-33475321-2']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-33475321-2');
    ga('send', 'pageview');
</script>
	<script type="text/javascript">
	  var disqus_shortname = 'ams-blog';
          var disqus_identifier = '../drafts/tls-the-hard-way-with-python.html';
          var disqus_url = '../drafts/tls-the-hard-way-with-python.html';
          var disqus_title = 'TLS the hard way with python';
	  (function() {
	    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
	    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	   })();
	</script>
</body>
</html>