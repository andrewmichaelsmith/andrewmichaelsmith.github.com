<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>Andy Smith's Blog - Developing an iOS app on Linux in 2017</title>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css"/>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab|Ruda"/>
        <link rel="stylesheet" type="text/css" href="https://andrewmichaelsmith.com/theme/css/main.css"/>
            <link href="https://andrewmichaelsmith.com/
feeds/all.atom.xml"
                  type="application/atom+xml" rel="alternate" title="Andy Smith's Blog Atom Feed"/>

<meta name="tags" content="ios" />
<meta name="tags" content="app store" />
<meta name="tags" content="linux" />
<meta name="tags" content="cordova" />
</head>
<body>
<a href="https://github.com/andrewmichaelsmith/" class="github-corner" aria-label="View source on GitHub">
    <svg width="80" height="80" viewBox="0 0 250 250"
         style="fill:#8B8B7A; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
<style>.github-corner:hover .octo-arm {
    animation: octocat-wave 560ms ease-in-out
}
@keyframes octocat-wave {
    0%, 100% {
        transform: rotate(0)
    }
    20%, 60% {
        transform: rotate(-25deg)
    }
    40%, 80% {
        transform: rotate(10deg)
    }
}
@media (max-width: 500px) {
    .github-corner:hover .octo-arm {
        animation: none
    }

    .github-corner .octo-arm {
        animation: octocat-wave 560ms ease-in-out
    }
}</style><div id="container">
    <header>
        <h1><a href="https://andrewmichaelsmith.com/">Andy Smith's Blog</a></h1>
            <ul class="social-media">
                    <li><a href="https://andrewmichaelsmith.com/
feeds/all.atom.xml"
                           type="application/atom+xml" rel="alternate"><i class="fa fa-rss fa-lg"
                                                                          aria-hidden="true"></i></a></li>
            </ul>
        <p><em></em></p>
    </header>
    <nav>
        <ul>
                    <li><a                         class="active" href="https://andrewmichaelsmith.com/category/blog.html"> Blog </a></li>
                    <li><a href="https://andrewmichaelsmith.com/pages/contact.html">Contact</a>
                    </li>
        </ul>
    </nav>
<main>
    <article>
        <h1>Developing an iOS app on Linux in 2017</h1>
        
        <aside>
            <ul>
                <li>
                    <time datetime="2017-02-28 00:00:00+00:00">Feb 28, 2017</time>
                </li>
                <li>
                    Categories:
                    <a href="https://andrewmichaelsmith.com/category/blog.html"><em>Blog</em></a>
                </li>
                <li>
                    Tags:
                    <a href="https://andrewmichaelsmith.com/tag/ios.html"><em>#ios</em></a>
                    <a href="https://andrewmichaelsmith.com/tag/app-store.html"><em>#app store</em></a>
                    <a href="https://andrewmichaelsmith.com/tag/linux.html"><em>#linux</em></a>
                    <a href="https://andrewmichaelsmith.com/tag/cordova.html"><em>#cordova</em></a>
                </li>
            </ul>
        </aside>
        <p>I've just published an iOS app on the app store, I developed it (mostly) using
Linux (Ubuntu). Here I have documented some of the challenges and discoveries 
for anyone considering doing the same. </p>
<p>Before anyone gets too exicted, this is a
<a href="https://cordova.apache.org/">Cordova</a> app. That means it basically a web app
(HTML, CSS, Javascript) served in a web view. There's no Swift or Objective-C 
here (at least, not written by me). Furthermore, my total solution uses <em>two</em> 
hosted Mac OS offerings.  The day to day development still sticks to Linux, but 
I didn't find a solution that doesn't touch Mac.</p>
<p>This post won't go in to much detail about the limitations of a cordova app over 
a &quot;native&quot; app, as these are already documented elsewhere. I will 
say that you can produce a decent looking, responsive, completely offline
application that Apple will accept on their app store using this mechanism. </p>
<h2>Linux and iOS Development</h2>
<p>Apple are not exactly known for making development for their platforms easy 
on operating systems that aren't Mac OS. If you look in to this you will find
people on the internet advising that even developing a basic Cordova app would 
be made a lot easier by buying a mac.</p>
<p>But I'm a Linux user, so I'm not necessarily that interested in making my life 
easy.</p>
<p>When I started out my main concerns were:</p>
<ul>
<li>Testing my app locally in an emulator.</li>
<li>Building a release to to test on an iPhone.</li>
<li>Running my app on an iPhone.</li>
<li>Remotely debugging my app on an iPhone.</li>
<li>Building an app store ready release.</li>
<li>Uploading my release to the app store.</li>
</ul>
<p>It turned out these were all things to be worried about (some solveable, some
not), I'd missed one:</p>
<ul>
<li>Producing screenshots for the app store.</li>
</ul>
<h2>Development Environment</h2>
<p>Before we address each of these points I'll give you a quick overview of my
setup. I went for the classic gulp/bower/npm/etc. combo. I used the AngularJS
framework.</p>
<p>I used a <a href="http://mobileangularui.com/blog/using-the-generator/">generator</a> to get
started. I ultimately regret this, it got me going quickly but left huge gaps in
my knowledge. Next time I would use such a project as a reference, but hand
pick the pieces I wanted.</p>
<p>This generator gave me some .html and .js I could edit, some commands I could 
run to serve them to my web browser from a local web server.</p>
<p>With this and <a href="https://developers.google.com/web/tools/chrome-devtools/device-mode/">Chrome Device Mode</a>
I was able to develop a web page and look at what it might look like on an iPhone.</p>
<p>Whilst that's OK, Chrome is not the web view that Cordova runs on the iPhone, so
we don't really have any guarantees that the app will look as we see it on our
computer. That brings us to the first concern.</p>
<h2>Testing my app locally in an emulator</h2>
<p>It's quite simple - if you don't run Mac OS you can't run an iPhone emulator. 
There are browser plugins (and the previously mentioend device mode) that will 
make a browser sort of look like a phone, but that's your lot.</p>
<p>Personally I found that for 95% of cases Chrome was similar enough. The other 5%
we'll get to later.</p>
<p>(See "Producing screenshots" if you really want to run an emulator).</p>
<h2>Building a release to to test on an iPhone</h2>
<p>Again, this I couldn't achieve purely on Linux. This brings us to my first cheat.</p>
<p><a href="http://phonegap.com/">Adobe Phonegap</a> is a commercial service based upon 
Cordova. If you create a (free) account with them they will build iPhone
binaries for you (for free).</p>
<p>There's one more hoop before that will work - certificiates. The iPhone
won't accept a binary which isn't signed by a certificate from Apple. And the
only way to get your hands on one of these is to give money to Apple.</p>
<p>Once you sign up and pay for an Apple Developer account you will get some
development certificates. You plug these in to phonegap, along with your
project's git repo, and a .ipa file is produced.</p>
<h2>Running my app on an iPhone</h2>
<p>Here comes our first pleasant surprise - I can take my phonegap built .ipa and
install it on to my iPhone straight from Linux using
<a href="https://github.com/libimobiledevice/ideviceinstaller">ideviceinstaller</a>. It's
this simple:</p>
<div class="highlight"><pre><span></span><code><span class="n">ideviceinstaller</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">app</span><span class="o">.</span><span class="n">ipa</span><span class="w"></span>
<span class="n">WARNING</span><span class="p">:</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">locate</span><span class="w"> </span><span class="n">iTunesMetadata</span><span class="o">.</span><span class="n">plist</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">archive</span><span class="o">!</span><span class="w"></span>
<span class="n">WARNING</span><span class="p">:</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">locate</span><span class="w"> </span><span class="n">Payload</span><span class="o">/</span><span class="n">app</span><span class="o">.</span><span class="n">app</span><span class="o">/</span><span class="n">SC_Info</span><span class="o">/</span><span class="n">app</span><span class="o">.</span><span class="n">sinf</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">archive</span><span class="o">!</span><span class="w"></span>
<span class="n">Copying</span><span class="w"> </span><span class="s1">&#39;app.ipa&#39;</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">device</span><span class="o">...</span><span class="w"> </span><span class="n">DONE</span><span class="o">.</span><span class="w"></span>
<span class="n">Installing</span><span class="w"> </span><span class="s1">&#39;net.app.example&#39;</span><span class="w"></span>
<span class="n">Install</span><span class="p">:</span><span class="w"> </span><span class="n">CreatingStagingDirectory</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="o">%</span><span class="p">)</span><span class="w"></span>
<span class="n">Install</span><span class="p">:</span><span class="w"> </span><span class="n">ExtractingPackage</span><span class="w"> </span><span class="p">(</span><span class="mi">15</span><span class="o">%</span><span class="p">)</span><span class="w"></span>
<span class="n">Install</span><span class="p">:</span><span class="w"> </span><span class="n">InspectingPackage</span><span class="w"> </span><span class="p">(</span><span class="mi">20</span><span class="o">%</span><span class="p">)</span><span class="w"></span>
<span class="n">Install</span><span class="p">:</span><span class="w"> </span><span class="n">TakingInstallLock</span><span class="w"> </span><span class="p">(</span><span class="mi">20</span><span class="o">%</span><span class="p">)</span><span class="w"></span>
<span class="n">Install</span><span class="p">:</span><span class="w"> </span><span class="n">PreflightingApplication</span><span class="w"> </span><span class="p">(</span><span class="mi">30</span><span class="o">%</span><span class="p">)</span><span class="w"></span>
<span class="n">Install</span><span class="p">:</span><span class="w"> </span><span class="n">InstallingEmbeddedProfile</span><span class="w"> </span><span class="p">(</span><span class="mi">30</span><span class="o">%</span><span class="p">)</span><span class="w"></span>
<span class="n">Install</span><span class="p">:</span><span class="w"> </span><span class="n">VerifyingApplication</span><span class="w"> </span><span class="p">(</span><span class="mi">40</span><span class="o">%</span><span class="p">)</span><span class="w"></span>
<span class="n">Install</span><span class="p">:</span><span class="w"> </span><span class="n">CreatingContainer</span><span class="w"> </span><span class="p">(</span><span class="mi">50</span><span class="o">%</span><span class="p">)</span><span class="w"></span>
<span class="n">Install</span><span class="p">:</span><span class="w"> </span><span class="n">InstallingApplication</span><span class="w"> </span><span class="p">(</span><span class="mi">60</span><span class="o">%</span><span class="p">)</span><span class="w"></span>
<span class="n">Install</span><span class="p">:</span><span class="w"> </span><span class="n">PostflightingApplication</span><span class="w"> </span><span class="p">(</span><span class="mi">70</span><span class="o">%</span><span class="p">)</span><span class="w"></span>
<span class="n">Install</span><span class="p">:</span><span class="w"> </span><span class="n">SandboxingApplication</span><span class="w"> </span><span class="p">(</span><span class="mi">80</span><span class="o">%</span><span class="p">)</span><span class="w"></span>
<span class="n">Install</span><span class="p">:</span><span class="w"> </span><span class="n">GeneratingApplicationMap</span><span class="w"> </span><span class="p">(</span><span class="mi">90</span><span class="o">%</span><span class="p">)</span><span class="w"></span>
</code></pre></div>

<p>And that's it - I get my app running on my phone exactly as it will be when I
sell it. It pops up on the home screen and I can launch, easy.</p>
<h2>Remotely debugging my app on an iPhone</h2>
<p>As anyone who's written code for a browser will know - browser quirks can be the
most infuriating issues to code for and around. This is the 5% of problems I
mentioend previously.</p>
<p>Whether it's CSS or Javascript - being able to open the debug console and tweak
things is incredinly useful. As you may have already figured out, the cycle of -
commit to git, push to git, build binary on third party service (phonegap),
download binary, install binary to phone, launch binary - is not exactly a quick
feeback loop.</p>
<p>This brings us to our second pleasant discovery. We can use the
<a href="https://github.com/google/ios-webkit-debug-proxy">ios_webkit_debug_proxy</a> in
conjunction with our running app. This allows us to use Chrome devtools on our
computer, attached to the Safari webview running in our app on the phone. This 
makes debugging all manor of browser specific problems a lot easier. </p>
<div class="highlight"><pre><span></span><code>$ ios_webkit_debug_proxy -f chrome-devtools://devtools/bundled/inspector.html
Listing devices on :9221
Connected :9222 to Andrew<span class="err">&#39;</span>s iPhone <span class="o">(</span>c8fed00eb2e87f1cee8e90ebbe870c190ac3848c<span class="o">)</span>
</code></pre></div>

<p>It's that easy - then through Chrome I can twiddle CSS and run Javascript in my
app.</p>
<h2>Building an app store ready release</h2>
<p>This is the same as how we build our .ipa for testing, the only difference is we
have to use some different certificates from Apple. The process is otherwise
identical - and phonegap will pop out a production ready .ipa.</p>
<h2>Uploading my release to the app store</h2>
<p>This was a bit of a shock. Naturally on a mac this process integrates in to 
XCode and those lucky developers can upload to the app store (iTunes Connect) at
the push of a button.</p>
<p>I had assumed there would be some web interface (as there is to configure all
other pieces of the app) to allow for submission of our binary. This is not the
case. </p>
<p>Your two options are:</p>
<ul>
<li>XCode</li>
<li>Application Loader</li>
</ul>
<p>Both of these are native Mac OS tools. This brings us to our second cheat.
Unfortunately phonegap aren't kind enough to offer this service for us, but
there's another option: <a href="http://www.macincloud.com/">MacinCloud</a>. For a fee ($1
an hour) you can access a full blown Mac OS instance with Application Loader 
available (accessible via <code>rdesktop</code>).</p>
<p>Using this service, it's possible to upload the .ipa to the app store for public
release.</p>
<p>(In searching for solutions to this I also found various
random-people-on-the-internet who in exchange for some cash and all your Apple
login details would submit your app for you from their mac. I did not go down 
this fairly sketchy route).</p>
<h2>Producing screenshots for the app store</h2>
<p>We're not quite finished yet! Chances are you want to upload some screenshots
of your application. iTunes Connect has a thing called Media Manager which will
helpfully take screenshots of the highest iPhone resoltuion and scale them down
for you. At time of writing this is 2208x1242 pixels. That is unfortunately more
pixels than I have on my laptop.</p>
<p>There's no verification of the images you upload (from what I can see), so you 
could fake these in any way you like, but if you want to produce a bunch of
screenshots of your actual app you may end up doing what I did - uploading your
code to Macincloud, running it in Xcode and using the iPhone 7 emulator +
screenshot functionality.</p>
<h2>Conclusion</h2>
<p>Whilst there were a few hoops to jump through in this process, the whole ordeal
was not that painful. Throughout the project I was prepared to just go and get a 
mac but I was keen to avoid this if I could.</p>
<p>The main times I found myself truly swearing at my computer were when I was
trying to set up <a href="https://cordova.apache.org/plugins/">plugins</a> - for which
(when I got things wrong) the feedback loop was infuriatingly slow. </p>
<p>All in all I think it was fine to do it this way and I'm glad that to maintain
my iOS project I can use my regular development environment. Admittedly, a great
deal of the ease comes from the fact that this is a web app - which should be
easy to develop on any platform.</p>
    </article>
    <section class="post-nav">
        <div id="left-page">
            <div id="left-link">
            </div>
        </div>
        <div id="right-page">
            <div id="right-link">
            </div>
        </div>
    </section>
    <div>
    <div class="comments">
        <h2>Comments !</h2>
        <div id="disqus_thread"></div>
        <script>
            var disqus_config = function () {
                this.page.url = "https://andrewmichaelsmith.com/2017/02/developing-an-ios-app-on-linux-in-2017/";
                this.page.identifier = "developing-an-ios-app-on-linux-in-2017";
                this.page.title = "Developing an iOS app on Linux in 2017";
            };
            (function () {
                var d = document,
                    s = d.createElement('script');
                s.src = 'https://ams-blog.disqus.com/embed.js';
                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments
            powered by
            Disqus.</a></noscript>
    </div>
    </div>
</main>
    <footer>
        <h6>
            Rendered by <a href="http://getpelican.com/">Pelican</a> &nbsp;&bull;&nbsp; Theme by <a
                href="https://github.com/aleylara/Peli-Kiera">Peli-Kiera</a> &nbsp;&bull;&nbsp; Copyright
                &copy &nbsp;&#8209;&nbsp; Andrew Smith         </h6>
    </footer>
</div>
</body>
</html>
