<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Getting Dionaea to scan previously collected Malware</title>
  <meta name="author" content="Andrew Smith">



  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="../../../favicon.png" rel="icon">
  <link href="../../../theme/css/main.css" media="screen, projection"
        rel="stylesheet" type="text/css">
  <script src="../../../theme/js/modernizr-2.0.js"></script>
  <script src="../../../theme/js/ender.js"></script>
  <script src="../../../theme/js/octopress.js" type="text/javascript"></script>

  <link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
  <link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
</head>

<body>
  <header role="banner"><hgroup>
  <h1><a href="../../../">Andy Smith's Blog</a></h1>
</hgroup></header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
</ul>



<ul class="main-navigation">
      <li><a href="../../../pages/bluepot.html">bluepot</a></li>
      <li><a href="../../../pages/chump.html">chump</a></li>
      <li><a href="../../../pages/contact.html">Contact</a></li>
    <li class="active">
    <a href="../../../category/blog.html">Blog</a>
    </li>
</ul></nav>
  <div id="main">
    <div id="content">
<div>
  <article class="hentry" role="article">
<header>
      <h1 class="entry-title">Getting Dionaea to scan previously collected Malware</h1>
      <p class="meta"><time datetime="2011-01-10T14:52:39+00:00" pubdate>Mon 10 January 2011</time></p>
</header>

  <div class="entry-content"><ul>
<li>Dionaea</li>
<li>Honeypots</li>
<li>Virustotal
tags:</li>
<li>virustotal dionaea</li>
</ul>
<p><strong>Update:</strong> This is in old post and the scripts got lost when I moved hosts. There is a script here: <a href="http://carnivore.it/2010/10/07/virustotal_api">http://carnivore.it/2010/10/07/virustotal_api</a> under "processing backlog" that will do what I describe below.</p>
<p>I finally got around to signing up for a <a href="http://www.virustotal.com/advanced.html#publicapi">Virustotal API key</a> and popping it in to my <a href="http://dionaea.carnivore.it/">Dionaea</a> configuration. This gave my logs a lot more information for the new malware that was collected. My problem was that all my previous files had no Virustotal scan information attached.</p>
<p>This would not do, so I wrote a Python script to populate the 'vtcache.sqlite' database with all the previous, unscanned pieces of malware. This will cause dionaea to scan all of the old malware with Virustotal and update the dionaea database with all that tasty data.</p>
<p>Most of the magic here is the work of dionaea, all my script does is copy some data from one table to another. You must have the old malware still and the script is written for a setup, like mine, where most of the logs and malware is just left at default.</p>
<p>The script is set up with dionaea defaults for directories, if yours are different you will need to change them by editing the file.</p>
<p>Once configured, simply run:</p>
<blockquote>
<p>python vupdate.py</p>
</blockquote>
<p>No output is good output. That's all! Any feedback is appreciated, this is definitely experimental so backup anything important before you run it.</p></div>
    <footer>
<p class="meta">
  <span class="byline author vcard">
    Posted by <span class="fn">Andrew Smith</span>
  </span>
<time datetime="2011-01-10T14:52:39+00:00" pubdate>Mon 10 January 2011</time>  <span class="categories">
    <a class="category" href="../../../tag/.html"></a>
  </span>
</p><div class="sharing">
</div>    </footer>
  </article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
  </section>
</div>
<aside class="sidebar">
  <section>
    <h1>Recent Posts</h1>
    <ul id="recent_posts">
      <li class="post">
          <a href="../../../2015/03/running-manuka-docker-honeypot/">Running manuka docker honeypot</a>
      </li>
      <li class="post">
          <a href="../../../2014/05/docker-volume-and-docker-volume/">Docker volume and docker VOLUME</a>
      </li>
      <li class="post">
          <a href="../../../2014/03/quick-and-easy-ssh-mitm/">Quick and Easy SSH MITM</a>
      </li>
      <li class="post">
          <a href="../../../2013/08/raspberry-pi-wi-fi-honeypot/">Raspberry Pi Wi-Fi Honeypot</a>
      </li>
      <li class="post">
          <a href="../../../2013/04/the-15-dollar-honeypot/">The $15 (per year) Honeypot</a>
      </li>
    </ul>
  </section>
  <section>
      
    <h1>Categories</h1>
    <ul id="recent_posts">
        <li><a href="../../../category/blog.html">Blog</a></li>
    </ul>
  </section>
 

  <section>
  <h1>Tags</h1>
    <a href="../../../tag/.html"></a>,    <a href="../../../tag/raspberry-pi.html">raspberry-pi</a>,    <a href="../../../tag/dionaea.html">dionaea</a>,    <a href="../../../tag/honeypots.html">honeypots</a>,    <a href="../../../tag/volume.html">volume</a>,    <a href="../../../tag/gwt.html">gwt</a>,    <a href="../../../tag/kippo.html">kippo</a>,    <a href="../../../tag/mitm.html">mitm</a>,    <a href="../../../tag/ssh.html">ssh</a>,    <a href="../../../tag/ec2-honeypot.html">ec2 honeypot</a>,    <a href="../../../tag/docker.html">docker</a>,    <a href="../../../tag/wi-fi.html">wi-fi</a>,    <a href="../../../tag/honeypot.html">honeypot</a>,    <a href="../../../tag/access-point.html">access-point</a>  </section>



  <section>
    <h1>GitHub Repos</h1>
    <ul id="gh_repos">
      <li class="loading">Status updating...</li>
    </ul>
    <script type="text/javascript">
      $.domReady(function(){
          if (!window.jXHR){
              var jxhr = document.createElement('script');
              jxhr.type = 'text/javascript';
              jxhr.src = '../../../theme/js/jXHR.js';
              var s = document.getElementsByTagName('script')[0];
              s.parentNode.insertBefore(jxhr, s);
          }

          github.showRepos({
              user: 'andrewmichaelsmith',
              count: 5,
              skip_forks: false,
              target: '#gh_repos'
          });
      });
    </script>
    <script src="../../../theme/js/github.js" type="text/javascript"> </script>
  </section>


<section>
    <p>Follow <a href="http://twitter.com/bingleybeep">@bingleybeep</a></p>
</section>
</aside>    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Andrew Smith -
  <span class="credit">Powered by <a href="http://getpelican.com">Pelican</a></span>
</p></footer>
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-33475321-2']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-33475321-2');
    ga('send', 'pageview');
</script>
	<script type="text/javascript">
	  var disqus_shortname = 'ams-blog';
          var disqus_identifier = '../../../2011/01/getting-dionaea-to-scan-previously-collected-malware/';
          var disqus_url = '../../../2011/01/getting-dionaea-to-scan-previously-collected-malware/';
          var disqus_title = 'Getting Dionaea to scan previously collected Malware';
	  (function() {
	    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
	    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	   })();
	</script>
</body>
</html>